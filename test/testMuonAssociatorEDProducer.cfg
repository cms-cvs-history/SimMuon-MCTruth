process myproc = {

    untracked PSet maxEvents = {untracked int32 input = -1}

    source = PoolSource {
         untracked vstring fileNames = 
         {'file:RelVal.root'}
    }

### MessageLogger

    include "FWCore/MessageService/data/MessageLogger.cfi"
    replace MessageLogger.categories     = { "testReader","MuonAssociatorEDProducer","MuonAssociatorByHits",
					     "DTHitAssociator","RPCHitAssociator","MuonTruth","PSimHitMap",
					     "FwkJob", "FwkReport", "FwkSummary", "Root_NoDictionary"}
    replace MessageLogger.cout = {
        untracked bool noTimeStamps = true 
        untracked string threshold = "INFO"
        untracked PSet INFO = { untracked int32 limit = 0  }
        untracked PSet default = { untracked int32 limit = 10000000 }
        untracked PSet testReader = { untracked int32 limit = 10000000 }
        untracked PSet MuonAssociatorEDProducer = { untracked int32 limit = 10000000 }
        untracked PSet MuonAssociatorByHits = { untracked int32 limit = 10000000 }
        untracked PSet DTHitAssociator = { untracked int32 limit = 10000000 }
        untracked PSet RPCHitAssociator = { untracked int32 limit = 10000000 }
        untracked PSet MuonTruth = { untracked int32 limit = 10000000 }
        untracked PSet PSimHitMap = { untracked int32 limit = 10000000 }
        untracked PSet FwkReport  = { untracked int32 limit = 10000000 
                                      untracked int32 reportEvery = 1 }
        untracked PSet FwkSummary = { untracked int32 limit = 10000000
	                              untracked int32 reportEvery = 1 }
        untracked PSet FwkJob     = { untracked int32 limit = 0 } 
        untracked PSet Root_NoDictionary = { untracked int32 limit = 0 }
    }
    replace MessageLogger.statistics = {"cout"} 
    replace MessageLogger.cerr = { untracked bool placeholder = true }

#service=Tracer{}

### Mixing Module
    include "SimGeneral/MixingModule/data/mixNoPU.cfi"  

#--- TrackingParticle collection has to include muon hits ----------------------
    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi" 
#-------------------------------------------------------------------------------

    include "Configuration/StandardSequences/data/Services.cff"
    include "Configuration/StandardSequences/data/Geometry.cff"
    include "Configuration/StandardSequences/data/MagneticField.cff"
    include "Configuration/StandardSequences/data/Simulation.cff"
    include "Configuration/StandardSequences/data/FakeConditions.cff"
    include "Configuration/StandardSequences/data/RawToDigi.cff"
    include "Configuration/StandardSequences/data/Reconstruction.cff"

### MuonAssociatorByHits
    include "SimMuon/MCTruth/data/MuonAssociatorByHits.cfi"

# for standalone muons (default)
#    replace muonAssociatorByHits.tracksTag = standAloneMuons
##    replace muonAssociatorByHits.tracksTag = standAloneMuons:UpdatedAtVtx
#    replace muonAssociatorByHits.SimToReco_useTracker = false
#    replace muonAssociatorByHits.SimToReco_useMuon = true
#
# for global muons 
#    replace muonAssociatorByHits.tracksTag = globalMuons
#    replace muonAssociatorByHits.SimToReco_useTracker = true
#    replace muonAssociatorByHits.SimToReco_useMuon = true

### test analysis
    module testanalyzer = testReader {
       InputTag tracksTag = standAloneMuons
#       InputTag tracksTag = standAloneMuons:UpdatedAtVtx
#       InputTag tracksTag = globalMuons
       InputTag tpTag = mergedtruth:MergedTrackTruth
       InputTag assoMapsTag = muonAssociatorByHits
    }
   
### Event content
    include "Configuration/EventContent/data/EventContent.cff"

### example output
    module MyOut = PoolOutputModule
    {
	untracked string fileName = "test.root"
	untracked vstring outputCommands = {
	    "drop *",          
	    "keep recoTracks_standAloneMuons_*_*",
	    "keep recoTracks_globalMuons_*_*",
            "keep TrackingParticles_mergedtruth_MergedTrackTruth_*",
	    "keep *_muonAssociatorByHits_*_*"
	}
    }

### define path

sequence My_trackingMuons = {(mix,trackingParticles)}
sequence My_RawToDigi = {(((((siPixelDigis) & SiStripRawToDigis) & muonCSCDigis) & muonDTDigis) & muonRPCDigis)}
sequence My_localreco = {(trackerlocalreco & muonlocalreco)}
sequence My_globalreco = {((offlineBeamSpot & (recopixelvertexing,ckftracks)) & muontracking)}
sequence My_reconstruction = {(My_localreco,My_globalreco)}

path mixing = {mix}
path My_trackingAnalysis = {My_trackingMuons}
path My_raw2digi_step = {My_RawToDigi}
path My_reconstruction_step = {My_reconstruction}
path muonAssociator = {muonAssociatorByHits}
path test = {testanalyzer}
endpath output = {MyOut}

schedule = {mixing,muonAssociator,test,output}
}
