process myana = {
    untracked PSet maxEvents = {untracked int32 input = -1}
    
    source = PoolSource {
	untracked vstring fileNames = {'file:RelVal-2_0_0_pre2-SingleMuPlusPt100.root'}
#	untracked vstring fileNames = {'file:RelVal-2_0_0_pre3-SingleMuPlusPt1000.root'}
    }

    service = RandomNumberGeneratorService
    {
	 untracked uint32 sourceSeed = 98765
	 PSet moduleSeeds =
	   {
	    untracked uint32 muonDTDigis = 563
	    untracked uint32 mix = 9823
	   }
    }

### MessageLogger

    include "FWCore/MessageService/data/MessageLogger.cfi"
    replace MessageLogger.categories     = { "testMyAssociator","MuonAssociatorByHits","DTHitAssociator" }
    replace MessageLogger.debugModules   = { "*" }
    replace MessageLogger.cout = {
        untracked string threshold = "INFO"
        untracked PSet default   = { untracked int32 limit = 0 }
        untracked PSet testMyAssociator = { untracked int32 limit = -1 }
        untracked PSet MuonAssociatorByHits = { untracked int32 limit = 0 }
        untracked PSet DTHitAssociator = { untracked int32 limit = 0 }
    }
    replace MessageLogger.cerr = { untracked bool placeholder = true }

### Mixing Module
    include "SimGeneral/MixingModule/data/mixNoPU.cfi"  

### Tracking Particle
    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"     # this is ok for Tracker tracks
#
# for standAloneMuons 
#    replace trackingtruthprod.TrackerHitLabels  = {"MuonDTHits","MuonCSCHits","MuonRPCHits"}
# for globalMuons
    replace trackingtruthprod.TrackerHitLabels += "MuonDTHits"
    replace trackingtruthprod.TrackerHitLabels += "MuonCSCHits"
    replace trackingtruthprod.TrackerHitLabels += "MuonRPCHits"

### Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

    include "Configuration/StandardSequences/data/Simulation.cff"
    include "Configuration/StandardSequences/data/FakeConditions.cff"
    include "Configuration/StandardSequences/data/Reconstruction.cff"

### Geometry
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
    include "Geometry/DTGeometry/data/dtGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi" 

### DT Digitization
    include "SimMuon/DTDigitizer/data/muonDTDigis.cfi"

### Local Muon Reconstruction
    include "RecoLocalMuon/Configuration/data/RecoLocalMuon.cff"

### StandaAlone & Global Muon Reconstruction
    include "RecoMuon/Configuration/data/RecoMuon.cff"

### Analyzer running MuonAssociatorByHits

module testanalyzer = testMyAssociator
{
#    InputTag tracksTag = generalTracks
#    InputTag tracksTag = standAloneMuons
    InputTag tracksTag = globalMuons

    InputTag tpTag = trackingtruthprod
    InputTag simtracksTag = g4SimHits

    bool debug = false
    bool crossingframe = true

    bool AbsoluteNumberOfHits = false
    string SimToRecoDenominator = "sim" #"reco"
    double MinHitCut = 0.5
    bool UsePixels = true
    bool UseGrouped = true
    bool UseSplitting = false
    bool ThreeHitTracksAreSpecial = false

    bool associatePixel = true
    bool associateStrip = true
    bool associateRecoTracks = true

    vstring ROUList = {
	#For running only strip or pixel comment out the appropriate strings
	#TIB
	"TrackerHitsTIBLowTof","TrackerHitsTIBHighTof",
	#TID
	"TrackerHitsTIDLowTof","TrackerHitsTIDHighTof",
	#TOB
	"TrackerHitsTOBLowTof","TrackerHitsTOBHighTof",
	#TEC
	"TrackerHitsTECLowTof","TrackerHitsTECHighTof",
	#BPIX
	"TrackerHitsPixelBarrelLowTof","TrackerHitsPixelBarrelHighTof",
	#FPIX
	"TrackerHitsPixelEndcapLowTof","TrackerHitsPixelEndcapHighTof"
    }

    bool dumpDT = false
    bool links_exist = true
    bool associatorByWire = false	
}

# Event output
    include "Configuration/EventContent/data/EventContent.cff"

    module Out = PoolOutputModule
    {
#     	 using FEVTSIMEventContent
	 untracked string fileName = "output.root"

	 untracked vstring outputCommands = {
      		"drop *",
                "keep *_*_*_myana",
                "drop *_mix_*_*",
                "drop *_TriggerResults_*_*",
                "keep *_source_*_*",
                "keep *_g4SimHits_*_*"
   	}
    }

# copy a few test events
    module COPY = PoolOutputModule
{
        untracked string fileName = "output.root"
}

    path p = {mix,trackingParticles,
	      muonDTDigis,muonlocalreco,muontracking,
              testanalyzer}

#    endpath e = {Out}
}
